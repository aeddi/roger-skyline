# 1
# Generated by iptables-save v1.4.21 on Sat Oct  8 11:30:51 2016
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [425:46725]

# SSH only from 42 School and ansible
-A INPUT -s 10.0.0.0/8 -p tcp -m tcp --dport 22 -j ACCEPT
#Init ansible
-A INPUT -s 192.168.54.10/32 -p tcp -m tcp --dport 22 -j ACCEPT

# Allow DHCP request
-A INPUT -s 192.168.154.0/24 -p udp -m multiport --dport 67,4338 -j ACCEPT

# Allow DNS request
-A INPUT -s 192.168.154.0/24 -p tcp -m multiport --dport 53,953 -j ACCEPT
-A INPUT -s 192.168.154.0/24 -p udp -m udp --dport 53 -j ACCEPT

# Zabbix agent accessible only from Zabbix server
-A INPUT -s 192.168.154.9/32 -p tcp -m tcp --dport 10050 -j ACCEPT

# ICMP accessible only from Zabbix server and ansible
-A INPUT -s 192.168.154.9/32 -p icmp -j ACCEPT
#Init ansible
-A INPUT -s 192.168.54.10/32 -p icmp -j ACCEPT

# Allow outgoing connection to connect back
-A INPUT -m state --state ESTABLISHED -j ACCEPT

# Allow all traffic from localhost
-A INPUT -i lo -j ACCEPT

# Reject everything else
-A INPUT -j REJECT --reject-with icmp-port-unreachable

COMMIT
# # Completed on Sat Oct  8 11:30:51 2016
