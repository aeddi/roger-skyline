---
- name: Update apt cache for further installs
  hosts: all
  remote_user: root
  tags: update_apt

  tasks:
    - name: Update apt cache
      apt: update_cache=yes


- name: Apply common configuration to all hosts
  hosts: all
  remote_user: root
  tags: common

  roles:
    - common


- name: Setup gateway
  hosts: gateway
  remote_user: root

  roles:
    - { role: dhcp, tags: dhcp }
    - { role: nat, tags: nat }
    #- { role: dns, tags: dns }


- name: Setup admin sys related tools on dedicated server
  hosts: adminsys
  remote_user: root

  roles:
    - { role: ldap, tags: ldap }
    - { role: syslog, tags: syslog } 
    - { role: monitoring, tags: monitoring } 
...
